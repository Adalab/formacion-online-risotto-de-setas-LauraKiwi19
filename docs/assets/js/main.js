"use strict";const selectAll=document.querySelector(".js-selectAll"),deselectAll=document.querySelector(".js-deselectAll"),title=document.querySelector(".js-title"),ingredientsList=document.querySelector(".js-ingredientsList"),items=document.querySelector(".js-totalItems"),subtotal=document.querySelector(".js-subtotal"),shippingCost=document.querySelector(".js-shippingCost"),totalPrice=document.querySelector(".js-total"),buyButton=document.querySelector(".js-buyButton");let ingredientsPrices=[],ingredientsToSum=[];const getDataFromApi=()=>{fetch("https://raw.githubusercontent.com/Adalab/recipes-data/master/rissoto-setas.json").then(e=>e.json()).then(e=>{printRecipe(e)})},getStartValues=()=>{const e=[...document.querySelectorAll(".js-list")];for(const t of e){let e=parseFloat(t.lastElementChild.innerText.split("€")[0]);ingredientsPrices.push({price:e,value:1,id:t.dataset.index})}},printRecipe=e=>{title.innerHTML=e.recipe.name;const t=e.recipe.ingredients;let n="";for(let e=0;e<t.length;e++)n+=`<li data-index=${e} class="ingredients__list js-list ${e%2==0?"":"ingredients__list-background"} ">`,n+="<div class='ingredients__data'><input class='ingredients__checkbox js-inputCheckbox' type='checkbox'/>",n+="<input class='ingredients__input js-inputNumber ' value='1' placeholder='1' name='quantity' min='1' type='number'/>",n+=`<div class="ingredients__info"> <h4 class="ingredients__info-title"> ${t[e].product}</h4>`,n+=`<h5 class="ingredients__info-brand">${void 0===t[e].brand?"":t[e].brand}</h5>`,n+=`<h6 class="ingredients__info-quantity">${t[e].quantity}</h6> </div> </div>`,n+=`<h3 class = 'ingredients__price js-ingredientPrice '>${t[e].price} €</h3> </li>`;ingredientsList.innerHTML=n,getStartValues(),listenToIngredients()},getIngredientPrice=e=>{let t={};const n=parseFloat(e.target.value),i=e.target.parentElement.parentElement.dataset.index;let s=e.target.parentElement.parentElement.lastElementChild.innerText;s=parseFloat(s.split("€")[0]),addPriceToArray(t={price:n*s,value:n,id:i})},sumTotalPrice=()=>{let e=0;for(let t=0;t<ingredientsToSum.length;t++)0===t?e=ingredientsToSum[t].price:e+=ingredientsToSum[t].price;printPrices(e)},addPriceToArray=e=>{let t=ingredientsPrices.findIndex(t=>t.id===e.id);if(0===ingredientsPrices.length?ingredientsPrices.push(e):(ingredientsPrices.splice(t,1),ingredientsPrices.push(e)),event.target.previousElementSibling.checked){const t=ingredientsToSum.findIndex(t=>t.id===e.id);ingredientsToSum.splice(t,1),ingredientsToSum.push(e)}countTotalItems(),sumTotalPrice()},printPrices=e=>{if(e>0){const t=e+7;subtotal.innerHTML=e.toFixed(2)+" €",totalPrice.innerHTML=t.toFixed(2)+" €",buyButton.innerHTML=t.toFixed(2)+" €"}else subtotal.innerHTML="0",totalPrice.innerHTML="0",buyButton.innerHTML=" "},countTotalItems=()=>{let e=0;for(const t of ingredientsToSum)e+=t.value;items.innerHTML=e},addIngredientsToSum=e=>{const t=e.target.parentElement.parentElement.dataset.index;if(e.target.checked)for(const e of ingredientsPrices)e.id===t&&ingredientsToSum.push(e);else{let e=ingredientsToSum.findIndex(e=>e.id===t);e>=0&&ingredientsToSum.splice(e,1)}countTotalItems(),sumTotalPrice()},selectAllIngredients=()=>{[...document.querySelectorAll(".js-inputCheckbox")].map(e=>{if(!e.checked)return e.checked=!0}),ingredientsToSum=[];for(const e of ingredientsPrices)ingredientsToSum.push(e);countTotalItems(),sumTotalPrice()},deselectAllIngredients=()=>{[...document.querySelectorAll(".js-inputCheckbox")].map(e=>{if(e.checked)return e.checked=!1}),ingredientsToSum=[],countTotalItems(),sumTotalPrice()},listenToIngredients=()=>{const e=document.querySelectorAll(".js-inputCheckbox");for(const t of e)t.addEventListener("change",addIngredientsToSum);const t=document.querySelectorAll(".js-inputNumber");for(const e of t)e.addEventListener("change",getIngredientPrice)};selectAll.addEventListener("click",selectAllIngredients),deselectAll.addEventListener("click",deselectAllIngredients),fetch("https://raw.githubusercontent.com/Adalab/recipes-data/master/rissoto-setas.json").then(e=>e.json()).then(e=>{printRecipe(e)});